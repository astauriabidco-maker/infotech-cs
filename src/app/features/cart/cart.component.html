<app-header></app-header>

<main class="cart-page">
  <div class="container">
    <div class="page-header">
      <h1 class="page-title">Mon Panier</h1>
      @if (cartService.cartSummary().itemCount > 0) {
        <button class="btn btn-ghost" (click)="clearCart()">Vider le panier</button>
      }
    </div>

    @if (cartService.cartSummary().items.length === 0) {
      <div class="empty-cart">
        <svg class="empty-icon" viewBox="0 0 24 24" fill="none">
          <path d="M9 2L7 6M17 6L15 2M3 6h18M18.74 6l-1.89 12.36A2 2 0 0 1 14.88 20H9.12a2 2 0 0 1-1.97-1.64L5.26 6" stroke="currentColor" stroke-width="2"/>
        </svg>
        <h2>Votre panier est vide</h2>
        <p>Commencez vos achats dès maintenant</p>
        <a routerLink="/products" class="btn btn-primary btn-lg">
          Découvrir les produits
        </a>
      </div>
    } @else {
      <div class="cart-content">
        <div class="cart-items">
          @for (item of cartService.cartSummary().items; track item.id) {
            <div class="cart-item">
              <div class="item-details">
                <h3 class="item-title">{{ item.productTitle }}</h3>
                <p class="item-brand">{{ item.productBrand }}</p>
                <p class="item-seller">Vendu par {{ item.sellerShopName }}</p>
              </div>

              <div class="item-quantity">
                <button class="quantity-btn" (click)="updateQuantity(item.id, item.quantity - 1)" [disabled]="item.quantity <= 1">
                  <svg viewBox="0 0 24 24" fill="none">
                    <line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2"/>
                  </svg>
                </button>
                <span class="quantity-value">{{ item.quantity }}</span>
                <button class="quantity-btn" (click)="updateQuantity(item.id, item.quantity + 1)">
                  <svg viewBox="0 0 24 24" fill="none">
                    <line x1="12" y1="5" x2="12" y2="19" stroke="currentColor" stroke-width="2"/>
                    <line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2"/>
                  </svg>
                </button>
              </div>

              <div class="item-price">
                {{ item.price * item.quantity | currency:'EUR':'symbol':'1.2-2':'fr' }}
              </div>

              <button class="item-remove" (click)="removeItem(item.id)">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2m3 0v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6h14z" stroke="currentColor" stroke-width="2"/>
                </svg>
              </button>
            </div>
          }
        </div>

        <div class="cart-summary">
          <h2 class="summary-title">Récapitulatif</h2>
          
          <div class="summary-row">
            <span>Sous-total</span>
            <span>{{ cartService.cartSummary().subtotal | currency:'EUR':'symbol':'1.2-2':'fr' }}</span>
          </div>

          <div class="summary-row">
            <span>Livraison</span>
            <span class="text-success">Gratuite</span>
          </div>

          <hr class="summary-divider">

          <div class="summary-row summary-total">
            <span>Total</span>
            <span>{{ cartService.cartSummary().total | currency:'EUR':'symbol':'1.2-2':'fr' }}</span>
          </div>

          <button class="btn btn-primary btn-lg w-full" (click)="proceedToCheckout()">
            Passer la commande
          </button>

          <a routerLink="/products" class="continue-shopping">
            Continuer mes achats
          </a>
        </div>
      </div>
    }
  </div>
</main>

<app-footer></app-footer>
